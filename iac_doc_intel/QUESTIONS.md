# IaC Doc Intelligence 활용 질문 가이드

`iac_doc_intel`을 최대한 활용하기 위한 질문 예시들을 카테고리별로 정리했습니다.

## 더 알아보기

실제 사용 사례와 활용 방향은 [EXAMPLES.md](./EXAMPLES.md)를 참고해 주세요.

## 문서 분류

### 기본 분류
- "classify terraform_sample.pdf"
- "classify kubernetes_sample.pdf"
- "classify ansible_sample.pdf"
- "이 파일이 어떤 종류의 IaC 문서인지 알려줘"

### 분류 후 후속 질문
- "왜 이 문서를 Terraform으로 분류했어?"
- "Ansible이 아니라 Terraform인 근거가 뭐야?"

## 문서 파싱

### PDF/이미지 파싱
- "parse terraform_fargate_sample.pdf"
- "parse ansible_lamp_haproxy_sample.pdf"
- "이 PDF에서 텍스트를 추출해줘"

### 파싱 결과 활용
- "방금 추출한 텍스트에서 리소스 목록을 정리해줘"
- "OCR 오류가 있는 부분 알려줘"
- "이 코드에서 변수와 출력값만 뽑아줘"

## 정보 추출

### 스키마 기반 추출
- "extract terraform_sample.pdf"
- "이 Terraform 파일에서 리소스와 변수 목록을 구조화해서 뽑아줘"
- "이 Kubernetes 매니페스트에서 컨테이너 이미지와 포트 정보만 추출해줘"
- "이 Ansible 플레이북에서 태스크 목록을 정리해줘"

### 추출 후 후속 질문
- "추출된 리소스 중에 보안그룹은 몇 개야?"
- "변수 중 sensitive로 표시된 건 뭐야?"
- "이 구성에 VPC는 몇 개 정의되어 있어?"

## 종합 분석

### 기본 분석
- "analyze terraform_fargate_sample.pdf"
- "analyze ansible_lamp_haproxy_sample.pdf"
- "이 파일을 보안, 비용, 안정성 관점에서 분석해줘"

### 관점을 지정한 분석
- "보안 관점에서만 분석해줘"
- "비용 최적화 가능한 부분만 봐줘"
- "고가용성 측면에서 부족한 점이 있어?"
- "베스트 프랙티스에 어긋나는 부분만 정리해줘"

## 분석 결과 위에서의 자연어 후속 질문

`analyze` 결과를 받은 뒤, 추가 도구 호출 없이 대화로 심층 탐색을 이어갈 수 있습니다.

### 보안 심층 분석
- "여기서 보안그룹 규칙 중 가장 위험한 건 뭐야?"
- "이 구성에서 시크릿이 노출될 수 있는 경로가 있어?"
- "IAM 역할이 최소 권한 원칙을 따르고 있어?"
- "egress 규칙이 왜 위험한지 설명해줘"
- "0.0.0.0/0을 쓰지 않으려면 어떻게 수정해야 해?"

### 비용 분석
- "이 구성의 월 예상 비용은 얼마나 될까?"
- "비용을 가장 많이 줄일 수 있는 항목은?"
- "NAT Gateway를 VPC Endpoint로 바꾸면 얼마나 절약돼?"
- "Fargate 대신 EC2를 쓰면 비용이 어떻게 달라져?"
- "Reserved Instance를 적용하면?"

### 아키텍처 분석
- "이 구성에서 단일 장애 지점은 없어?"
- "트래픽이 10배 늘면 어떤 부분이 병목이 될까?"
- "이 구성을 멀티 리전으로 확장하려면 뭘 추가해야 해?"
- "현재 오토스케일링 설정이 충분해?"

### 마이그레이션 분석
- "이 EC2 구성을 Fargate로 전환하려면 뭘 바꿔야 해?"
- "온프레미스에서 이 구성으로 마이그레이션할 때 주의할 점은?"
- "Aurora Serverless 대신 RDS를 쓰면 뭐가 달라져?"

### 코드 품질
- "이 코드에서 오타나 문법 오류가 있어?"
- "terraform fmt을 적용하면 어떤 부분이 바뀔까?"
- "모듈화할 수 있는 부분은?"
- "변수화하면 좋을 하드코딩된 값이 있어?"

## 대화형 워크플로우

한 번의 질문이 아니라 대화를 이어가면서 관점을 바꿔가며 분석할 수 있습니다.

### 종합 분석 → 보안 심층 → 비용 분석
```
> analyze terraform_fargate_sample.pdf
> 여기서 보안그룹 규칙 중 가장 위험한 건 뭐야?
> 이 구성의 월 예상 비용은 얼마나 될까?
> NAT Gateway를 제거하면 얼마나 절약돼?
```

### 파싱 → 구성 파악 → 개선 방향
```
> parse terraform_fargate_sample.pdf
> 어떤 리소스가 정의되어 있는지 정리해줘
> 이 구성에서 빠진 리소스가 있어?
> ALB + Target Group을 추가하려면 어떻게 해야 해?
```

### 분류 → 비교 분석
```
> classify terraform_sample.pdf
> classify ansible_sample.pdf
> 두 문서의 인프라 구성 차이를 비교해줘
```

### 후속 조치 유도 활용
```
> (분석 결과에서)
  "위 개선 항목을 하나씩 적용하면서 terraform plan → apply를 반복하세요."
> 1번 ALB 추가부터 구체적인 Terraform 코드를 보여줘
```

## 실무 시나리오 기반 질문

### 인프라 리뷰
- "이 Terraform 파일, 프로덕션에 적용해도 안전해?"
- "보안 감사에서 지적받을 만한 부분이 있어?"
- "이 구성으로 SOC2 컴플라이언스를 만족할 수 있어?"

### 장애 대응
- "이 구성에서 DB 커넥션 풀이 부족하면 어떤 증상이 나타날까?"
- "ECS 태스크가 OOM으로 죽으면 자동 복구되는 구조야?"
- "NAT Gateway에 장애가 발생하면 어떤 서비스가 영향받아?"

### 레거시 문서 분석
- "이 PDF가 어떤 인프라를 설명하는 건지 요약해줘"
- "이 문서에서 사용 중인 AWS 서비스 목록을 뽑아줘"
- "이 아키텍처의 데이터 흐름을 설명해줘"

### 인프라 마이그레이션 사전 분석
- "현재 EC2 구성과 Fargate 샘플을 비교해서 마이그레이션 갭을 분석해줘"
- "Fargate 전환 시 보안 관점에서 달라지는 점은?"
- "마이그레이션 시 추가해야 할 리소스 목록을 정리해줘"

## 사용 팁

1. **`analyze`로 시작**: 처음 파일을 볼 때는 `analyze`로 종합 분석을 먼저 받고, 관심 있는 관점으로 후속 질문을 이어가세요.
2. **관점을 명시**: "보안 관점에서", "비용 관점에서"처럼 관점을 지정하면 더 집중된 분석을 받을 수 있습니다.
3. **이전 맥락 활용**: 같은 세션에서 후속 질문을 하면 이전 분석 결과를 재활용합니다. 추가 도구 호출 없이 저비용으로 심층 분석이 가능합니다.
4. **사용량 추적**: `--usage` 플래그로 비용을 확인하면서 사용합니다.
   ```bash
   python3 iac_doc_intel/main.py --usage
   ```
