# Commit Guardian 활용 질문 가이드

`commit_guardian`을 최대한 활용하기 위한 질문 예시들을 카테고리별로 정리했습니다.

## 더 알아보기

실제 사용 사례와 활용 방향은 [EXAMPLES.md](./EXAMPLES.md)를 참고해 주세요.

## 코드 리뷰 (단축 명령)

### 기본 리뷰
- `review` — unstaged 변경사항 리뷰
- `staged` — staged 변경사항 리뷰
- `commit abc1234` — 특정 커밋 리뷰

### 테스트 제안
- `test` — unstaged 변경사항에 대한 테스트 제안 (변경 없으면 최근 커밋으로 fallback)
- `test staged` — staged 변경사항에 대한 테스트 제안
- `test abc1234` — 특정 커밋에 대한 테스트 제안

### 릴리스 노트
- `release` — 최근 커밋들 기반 릴리스 노트 생성 (한/영)

### 기타
- `repo /path/to/repo` — 저장소 경로 변경
- `clear` — 대화 초기화 (토큰 누적 방지)

## 코드 리뷰 (자연어)

> **주의**: 자연어 질문도 단축 명령과 동일하게 **diff 기반**으로 동작합니다. "에러 핸들링 봐줘"라고 하면 코드베이스 전체를 검색하는 것이 아니라, 현재 diff(unstaged/staged/커밋)에서 해당 관점으로 리뷰합니다. diff에 변경사항이 없으면 일반적인 체크리스트만 반환됩니다.
>
> 따라서 자연어 질문은 **단축 명령으로 diff를 확보한 뒤 후속 질문**으로 사용하는 것이 효과적입니다.

### 효과적인 사용: 단축 명령 + 자연어 후속 질문

```
> commit abc1234                        # 먼저 diff 확보
> 보안 관점에서만 더 자세히 봐줘          # 해당 diff 내에서 관점 지정
> 에러 핸들링도 추가로 확인해줘          # 같은 diff에서 다른 관점
```

### 관점 지정 리뷰 (diff가 있는 상태에서)
- "보안 관점에서만 리뷰해줘"
- "에러 핸들링만 봐줘"
- "성능 이슈 있는지 확인해줘"
- "코드 스타일 문제 있는지 봐줘"
- "테스트 커버리지 관점에서 검토해줘"

### 특정 패턴 검토 (diff가 있는 상태에서)
- "N+1 쿼리 문제 없는지 확인해줘"
- "하드코딩된 시크릿이 있는지 봐줘"
- "에러 메시지가 외부에 노출되는 부분 있는지 확인해줘"
- "미처리 예외나 빈 catch 블록 있는지 봐줘"
- "SQL 인젝션 가능성 있는 코드 있는지 확인해줘"

### 한계: diff 없이 자연어만 사용할 때

diff가 없는 상태에서 "에러 응답에 내부 정보가 노출되는 부분 있는지 봐줘" 같은 질문을 하면, 도구가 `get_git_diff`를 호출하지만 변경사항이 없으므로 **일반적인 체크리스트만 반환**됩니다. 코드베이스 전체를 검색하는 기능(`search_code`, `read_file`)은 제공하지 않습니다. 이는 "커밋/변경사항 리뷰"라는 도구의 설계 범위에 따른 것입니다. (→ [EXAMPLES.md 사례 2](./EXAMPLES.md) 참고)

## 보안 감사

> diff 내의 보안 이슈를 탐지합니다. 코드베이스 전체 보안 스캔이 아닌, **변경된 코드**에서의 보안 문제를 찾습니다.

### 보안 취약점 탐지 (커밋/diff 지정 후)
- "이 커밋에서 보안적으로 주의해야 할 부분 확인해줘"
- "민감 정보가 노출되는 코드 있는지 봐줘"
- "인증/권한 관련 변경사항 중 문제 있는 부분 있어?"
- "API 키나 비밀번호가 하드코딩된 곳이 있는지 확인해줘"

### 에러 처리 검토 (커밋/diff 지정 후)
- "에러 응답에 내부 정보가 노출되는 부분 있는지 봐줘"
- "err.Error()를 클라이언트에 직접 반환하는 곳이 있어?"
- "500 에러 대신 400으로 반환해야 하는 케이스가 있는지 확인해줘"

## 테스트 제안

### 기본 테스트 제안
- `test abc1234` — 특정 커밋의 변경사항에 대한 테스트 케이스 제안
- "이 변경사항에 대한 테스트 케이스 추천해줘"
- "에러 케이스 테스트는 어떤 걸 해야 해?"

### 관점별 테스트
- "경계값 테스트 케이스 추천해줘"
- "동시성 테스트가 필요한 부분이 있어?"
- "성능 테스트 시나리오 제안해줘"
- "DB 에러 시 에러 전파가 올바르게 되는지 확인하는 테스트 만들어줘"

## 릴리스 노트

### 기본 생성
- `release` — 최근 5개 커밋 기반 한/영 릴리스 노트
- "최근 변경사항으로 릴리스 노트 만들어줘"
- "이번 릴리스에 포함된 내용 정리해줘"

### 맥락 지정
- "보안 패치 위주로 릴리스 노트 작성해줘"
- "사용자 관점에서 릴리스 노트 작성해줘"
- "영어로만 릴리스 노트 만들어줘"

## 대화형 워크플로우

한 번의 질문이 아니라 대화를 이어가면서 점진적으로 활용할 수 있습니다.

### 리뷰 → 테스트 → 릴리스
```
> commit abc1234
> test abc1234
> release
```

### 리뷰 → 특정 관점 심화
```
> commit abc1234
> 방금 리뷰에서 보안 쪽 더 자세히 봐줘
> 에러 핸들링도 추가로 확인해줘
```

### 변경사항 없을 때 → 커밋 지정
```
> review
(변경 사항 없음)
> commit abc1234
```

### 세션 초기화 (토큰 절약)
```
> commit abc1234    (리뷰: ~80K 토큰)
> clear             (대화 초기화)
> test abc1234      (새 세션: ~10K 토큰)
```

## 실무 시나리오 기반 질문

### PR 리뷰 보조
- "이 커밋 머지해도 괜찮을까?"
- "리뷰어로서 지적해야 할 부분이 있어?"
- "이 변경사항의 사이드이펙트가 있을 수 있어?"

### 온보딩
- "이 커밋이 어떤 변경을 하는 건지 설명해줘"
- "이 코드의 맥락을 모르는 사람에게 설명하듯이 리뷰해줘"

### 리팩토링 리뷰
- "코드 중복이 있는지 확인해줘"
- "헬퍼 함수로 추출할 수 있는 패턴이 있어?"
- "트랜잭션 제거로 인한 부작용이 있을 수 있어?"

## 비용 최적화 팁

- `commit <hash>`로 대상을 명시하면 불필요한 `get_git_diff` 반복 호출을 방지합니다.
- 한 세션에서 여러 작업을 이어가면 토큰이 누적됩니다. 작업 간에 `clear`로 세션을 초기화하면 비용을 절약할 수 있습니다.
- `release`는 groundedness 검증이 없어 가장 저렴합니다 (~$0.0015).
- `review`/`commit`은 groundedness 검증이 포함되어 상대적으로 비쌉니다 (~$0.03).
